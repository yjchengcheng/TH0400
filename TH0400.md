# TH0400







### 注册

任何人都可以注册成为一名用户

注册需要提供以下信息：

*   用户名：用户自定义的用户名；具有唯一标示一名用户的功能，在系统中不可重复；字母、数字、下划线的组合，不可以有其它特殊字符；用户名不可更改；
*   密码：用户自定义的密码；后端不能存储密码明文；字母、数字、下划线的组合，不可以有其它特殊字符；密码可以修改
*   邮箱：用户自定义的邮箱；具有唯一标示一名用户的功能，在系统中不可重复；需要符合邮箱格式；邮箱可以修改；
*   学校：随便吧



注册成功后将自动执行登陆的流程



### 登陆

校验用户的用户名和密码，返回生成的JWT TOKEN。

Token应该有过期时间

服务端不存储Token



**note**：

*   使用JWT的话，如何进行用户注销。
*   重复登录如何撤销之前的Token。



### 获取公共用户信息

任何登陆、未登陆的客户端都可以根据用户ID获取用户的公共信息。

公共信息包括：用户名、用户等级、用户学校、用户粉丝数、用户获赞数、用户提出的问题、用户的回答。



**note：**

*   使用数据库自增ID作为用户ID的话很容易被爬虫，如何避免。





### 获取用户私人信息

仅用户登陆后可以获取自身的私人信息。

私人信息包括了所有的公共信息，除此之外还包括了：用户关注的问题、用户赞同的回答、用户邀请的回答、用户的草稿箱





## 接口



### 用户



#### 注册用户

##### 基本信息

**path**：/user

**method**：POST

**接口描述**：用户注册。

##### 请求参数

**header**

| 参数名称     | 参数值           | 是否必须 | 示例 | 备注 |
| ------------ | ---------------- | -------- | ---- | ---- |
| Content-Type | application/json | 是       |      |      |
|              |                  |          |      |      |

**body**

| 名称          | 类型   | 是否必须 | 默认值 | 备注 | 其它信息 |
| :------------ | ------ | -------- | ------ | ---- | -------- |
| user_name     | string | 是       |        |      |          |
| pass_word     | string | 是       |        |      |          |
| email_address | string | 是       |        |      |          |
| schooll       | string | 是       |        |      |          |

**请求body示例**

```json
{
    "user_name": "odlwang",
    "pass_word": "xxxxxddd",
    "email_address": "1044882877@qq.com",
    "schooll": "xxxschool"
}
```

**返回数据**

| 名称    | 类型   | 备注 | 其它信息 |
| ------- | ------ | ---- | -------- |
| user_id | num    |      |          |
| token   | string |      |          |
|         |        |      |          |


**返回body示例**

```json
{
    "user_id": 1234567,
    "token": "xxxxxddd"
}
```





#### 登陆

##### 基本信息

**path**：/user/login

**method**：POST

**接口描述**：用户登陆。

##### 请求参数

**header**

| 参数名称     | 参数值           | 是否必须 | 示例 | 备注 |
| ------------ | ---------------- | -------- | ---- | ---- |
| Content-Type | application/json | 是       |      |      |
|              |                  |          |      |      |

**body**

| 名称      | 类型   | 是否必须 | 默认值 | 备注 | 其它信息 |
| :-------- | ------ | -------- | ------ | ---- | -------- |
| user_name | string | 是       |        |      |          |
| pass_word | string | 是       |        |      |          |
|           |        |          |        |      |          |
|           |        |          |        |      |          |

**请求body示例**

```json
{
    "user_name": "oldwang",
    "pass_word": "xxxxxddd"
}
```

**返回数据**

| 名称    | 类型   | 备注 | 其它信息 |
| ------- | ------ | ---- | -------- |
| user_id | num    |      |          |
| token   | string |      |          |
|         |        |      |          |


**返回body示例**

```json
{
    "user_id": 1234567,
    "token": "xxxxxddd"
}
```





#### 获取用户公共信息

##### 基本信息

**path**：/user/pubinfo

**method**：GET

**接口描述**：获取公共用户信息。

##### 请求参数

**header**

| 参数名称     | 参数值           | 是否必须 | 示例 | 备注 |
| ------------ | ---------------- | -------- | ---- | ---- |
| Content-Type | application/json | 是       |      |      |
|              |                  |          |      |      |

**params**

| 名称    | 类型 | 是否必须 | 默认值 | 备注   | 其它信息 |
| ------- | ---- | -------- | ------ | ------ | -------- |
| user_id | num  | 是       |        | 用户ID |          |
|         |      |          |        |        |          |


**body**

| 名称 | 类型 | 是否必须 | 默认值 | 备注 | 其它信息 |
| :--- | ---- | -------- | ------ | ---- | -------- |
|      |      |          |        |      |          |



**返回数据**

| 名称            | 类型   | 备注 | 其它信息 |
| --------------- | ------ | ---- | -------- |
| user_name       | string |      |          |
| level           | num    |      |          |
| fans_count      | num    |      |          |
| likes_count     | num    |      |          |
| questions_count | num    | 定义 |          |
| answers_count   | num    |      |          |
|                 |        |      |          |


**返回body示例**

```json
{
    "user_name": "oldwang",
    "level":2,
    "fans_count":21,
    "likes_count":11,
    "questions_count":3,
    "answers_count":9
}
```



### 话题



#### 获取用户私有信息

##### 基本信息

**path**：/user/priinfo

**method**：GET

**接口描述**：获取用户私有信息。

##### 请求参数

**header**

| 参数名称      | 参数值           | 是否必须 | 示例 | 备注      |
| ------------- | ---------------- | -------- | ---- | --------- |
| Content-Type  | application/json | 是       |      |           |
| Authorization |                  |          |      | JWT Token |

**params定义**

| 名称    | 类型 | 是否必须 | 默认值 | 备注   | 其它信息 |
| ------- | ---- | -------- | ------ | ------ | -------- |
| user_id | num  | 是       |        | 用户ID |          |
|         |      |          |        |        |          |


**body**

| 名称 | 类型 | 是否必须 | 默认值 | 备注 | 其它信息 |
| :--- | ---- | -------- | ------ | ---- | -------- |
|      |      |          |        |      |          |



**返回数据**

| 名称            | 类型   | 备注 | 其它信息 |
| --------------- | ------ | ---- | -------- |
| user_name       | string |      |          |
| level           | num    |      |          |
| fans_count      | num    |      |          |
| likes_count     | num    |      |          |
| visit_count     | num    |      |          |
| drafts_count    | num    |      |          |
| questions_count | num    |      |          |
| answers_count   | num    |      |          |
|                 |        |      |          |


**返回body示例**

```json
{
    "user_name": "oldwang",
    "level": 2,
    "fans_count": 21,
    "likes_count": 11,
    "visit_count": 313,
    "drafts_count": 2,
    "questions_count": 3,
    "answers_count": 9
}
```





#### 获取一堆话题

##### 基本信息

**path**：/topics

**method**：GET

**接口描述**：获取一堆话题，根据传入的用户id，如果没有传入用户id或传入的用户id为0则获取所有。定义

##### 请求参数

**header**

| 参数名称     | 参数值           | 是否必须 | 示例 | 备注 |
| ------------ | ---------------- | -------- | ---- | ---- |
| Content-Type | application/json | 是       |      |      |
|              |                  |          |      |      |

**params**

| 名称      | 类型   | 是否必须 | 默认值 | 备注     | 其它信息 |
| --------- | ------ | -------- | ------ | -------- | -------- |
| user_id   | num    | 否       |        | 用户ID   |          |
| page_size | num    | 否       |        | 每页条数 |          |
| page_num  | num    | 否       |        | 第几页   |          |
| sort_by   | string | 否       |        | 排序     |          |
|           |        |          |        |          |          |


**body**

| 名称 | 类型 | 是否必须 | 默认值 | 备注 | 其它信息 |
| :--- | ---- | -------- | ------ | ---- | -------- |
|      |      |          |        |      |          |



**返回数据**

| 名称          | 类型     | 备注       | 其它信息 |
| ------------- | -------- | ---------- | :------- |
| topics        | []object | 一堆话题   |          |
| topic_id      | num      |            |          |
| topic_tags    | []string | 话题的标签 |          |
| topic_content | string   | 话题内容   |          |
| topic_name    | string   | 话题标题   |          |
|               |          |            |          |

**返回body示例**

```json
{
    "topics": [
        {
            "topic_id": 231,
            "topic_tags": [
                "猫哥",
                "狗哥"
            ],
            "topic_name": "如何有效学习英语",
            "topic_content": "从小..."
        }
    ]
}
```







#### 获取一个话题

##### 基本信息

**path**：/topic

**method**：GET

**接口描述**：根据话题ID获取某个话题及它的回答。

##### 请求参数

**header**

| 参数名称     | 参数值           | 是否必须 | 示例 | 备注 |
| ------------ | ---------------- | -------- | ---- | ---- |
| Content-Type | application/json | 是       |      |      |
|              |                  |          |      |      |

**params**

| 名称     | 类型 | 是否必须 | 默认值 | 备注   | 其它信息 |
| -------- | ---- | -------- | ------ | ------ | -------- |
| topic_id | num  | 否       |        | 用户ID |          |
|          |      |          |        |        |          |


**body**

| 名称 | 类型 | 是否必须 | 默认值 | 备注 | 其它信息 |
| :--- | ---- | -------- | ------ | ---- | -------- |
|      |      |          |        |      |          |



**返回数据**

| 名称           | 类型     | 备注         | 其它信息 |
| -------------- | -------- | ------------ | :------- |
| topic_id       | num      |              |          |
| topic_content  | string   | 话题内容     |          |
| topic_name     | string   | 话题标题     |          |
| answers        | []object | 该话题的回答 |          |
| answer_id      | num      | 回答的id     |          |
| answer_content | string   | 回答的内容   |          |

**返回body示例**

```json
{
    "topoc_id": 21321,
    "topic_name": "如何有效学习英语",
    "topic_content": "从小...",
    "answers": [
        {
            "answer_id": 42141,
            "answer_content": "猫哥没有小鸡鸡"
        }
    ]
}
```





#### 获得标签

#####基本信息

**path**:  /tags

**method**: GET

**接口描述**: 获取话题所属标签

**请求参数**

**header**

| 参数名称     | 参数内容         | 是否必须 |
| ------------ | ---------------- | -------- |
| Content-Type | application/json | 是       |
|              |                  |          |
|              |                  |          |

**params**

| 名称 | 类型 | 是否必须 | 默认值 | 备注 |
| ---- | ---- | -------- | ------ | ---- |
|      |      |          |        |      |

**body**

|      |      |      |      |      |
| ---- | ---- | ---- | ---- | ---- |
|      |      |      |      |      |



**返回数据**

| 名称     | 类型      | 备注                   |      |      |
| -------- | --------- | ---------------------- | ---- | ---- |
| tags     | []objects | 标签名称OkButNoData(c) |      |      |
| tag_id   | num       | tag的ID                |      |      |
| tag_name | string    | 标签值                 |      |      |

**返回body示例**

```json
{
    "tags": [
        {
            "tag_id": 421412,
            "tag_name": "猫哥"
        }
    ]
}
```









#### 发表回答

##### 基本信息

**path**：/answer

**method**：POST

**接口描述**：针对某个话题发表回答。

##### 请求参数

**header**

| 参数名称      | 参数值           | 是否必须 | 示例 | 备注      |
| ------------- | ---------------- | -------- | ---- | --------- |
| Content-Type  | application/json | 是       |      |           |
| Authorization |                  |          |      | JWT Token |

**body**

| 名称     | 类型 | 是否必须 | 默认值 | 备注             | 其它信息 |
| :------- | ---- | -------- | ------ | ---------------- | -------- |
| topic_id | num  | 是       |        | 所要回复的话题ID |          |
| content  | num  | 是       |        | 回复内容         |          |

```json
{
    "topic_id":213421,
    "content":"猫哥今年200近"
}
```



**返回数据**

| 名称 | 类型 | 备注 | 其它信息 |
| ---- | ---- | ---- | -------- |
|      |      |      |          |

**返回body示例**

```json

```



